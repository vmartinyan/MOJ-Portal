jQuery(document).ready(function(o){function a(a,e){a.preventDefault();var l=o(this),i=e.find(".kopa_upload"),n=i.data("type"),d=r.indexOf(n),s={title:l.data("choose"),button:{text:l.data("update"),close:!1}};p=e,n&&(-1===d&&r.push(n),s.library={type:n}),kopaframework_modals&&(t=kopaframework_modals[d]),t?t.open():(t=wp.media.frames.kopaframework_upload=wp.media(s),t.on("select",function(){var a=t.state().get("selection").first();t.close(),p.find(".kopa_upload").val(a.attributes.url),"image"==a.attributes.type&&(p.find(".kopa_screenshot").empty().hide().removeClass("kopa_hide").append('<img src="'+a.attributes.url+'"><a class="kopa_remove_image">'+kopa_upload_l10n.remove+"</a>").slideDown("fast"),(o("body").hasClass("widgets-php")||o("body").hasClass("post-php"))&&(p.find("img").css("max-width","100%"),o("<br>").insertBefore(p.find(".kopa_remove_image").addClass("button"))));var e=p.find(".kopa_upload_button").addClass("kopa_remove_file").removeClass("kopa_upload_button");e.text()?e.text(kopa_upload_l10n.remove):e.val()&&e.val(kopa_upload_l10n.remove)}),kopaframework_modals.push(t)),t.open()}function e(a,e){a.preventDefault(),e.find(".kopa_remove_image").hide(),e.find(".kopa_upload").val(""),e.find(".kopa_screenshot").slideUp("fast");var t=e.find(".kopa_remove_file").addClass("kopa_upload_button").removeClass("kopa_remove_file");t.text()?t.text(kopa_upload_l10n.upload):t.val()&&t.val(kopa_upload_l10n.upload),o(".kopa_section_upload .kopa_upload_notice").length>0&&o(".kopa_upload_button").remove()}Array.prototype.indexOf||(Array.prototype.indexOf=function(o,a){var e;if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),p=t.length>>>0;if(0===p)return-1;var r=+a||0;if(Math.abs(r)===1/0&&(r=0),r>=p)return-1;for(e=Math.max(r>=0?r:p-Math.abs(r),0);p>e;){if(e in t&&t[e]===o)return e;e++}return-1});var t,p,r=[];kopaframework_modals=[],o("body").on("click",".kopa_remove_image, .kopa_remove_file",function(a){e(a,o(this).closest(".kopa_section, .kopa-field_upload__outer"))}),o("body").on("click",".kopa_upload_button",function(e){a(e,o(this).closest(".kopa_section, .kopa-field_upload__outer"))})});
jQuery(document).ready(function(a){function o(o,e){o.preventDefault();var n=a(this),l=e.find(".kopa_upload"),i=l.data("type"),s=r.indexOf(i),d={title:n.data("choose"),button:{text:n.data("update"),close:!1}};p=e,i&&(-1===s&&r.push(i),d.library={type:i}),kopaframework_modals&&(t=kopaframework_modals[s]),t?t.open():(t=wp.media.frames.kopaframework_upload=wp.media(d),t.on("select",function(){var o=t.state().get("selection").first();t.close(),p.find(".kopa_upload").val(o.attributes.url),"image"==o.attributes.type&&(p.find(".kopa_screenshot").empty().hide().removeClass("kopa_hide").append('<img src="'+o.attributes.url+'"><a class="kopa_remove_image">'+kopa_upload_l10n.remove+"</a>").slideDown("fast"),(a("body").hasClass("widgets-php")||a("body").hasClass("post-php"))&&(p.find("img").css("max-width","100%"),a("<br>").insertBefore(p.find(".kopa_remove_image").addClass("button"))));var e=p.find(".kopa_upload_button").addClass("kopa_remove_file").removeClass("kopa_upload_button");e.text()?e.text(kopa_upload_l10n.remove):e.val()&&e.val(kopa_upload_l10n.remove)}),kopaframework_modals.push(t)),t.open()}function e(o,e){o.preventDefault(),e.find(".kopa_remove_image").hide(),e.find(".kopa_upload").val(""),e.find(".kopa_screenshot").slideUp("fast");var t=e.find(".kopa_remove_file").addClass("kopa_upload_button").removeClass("kopa_remove_file");t.text()?t.text(kopa_upload_l10n.upload):t.val()&&t.val(kopa_upload_l10n.upload),a(".kopa_section_upload .kopa_upload_notice").length>0&&a(".kopa_upload_button").remove()}Array.prototype.indexOf||(Array.prototype.indexOf=function(a,o){var e;if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),p=t.length>>>0;if(0===p)return-1;var r=+o||0;if(1/0===Math.abs(r)&&(r=0),r>=p)return-1;for(e=Math.max(r>=0?r:p-Math.abs(r),0);p>e;){if(e in t&&t[e]===a)return e;e++}return-1});var t,p,r=[];kopaframework_modals=[],a("body").on("click",".kopa_remove_image, .kopa_remove_file",function(o){e(o,a(this).closest(".kopa_section"))}),a("body").on("click",".kopa_upload_button",function(e){o(e,a(this).closest(".kopa_section"))})});
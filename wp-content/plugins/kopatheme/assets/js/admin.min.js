jQuery(document).ready(function(t){function e(){t(".kopa_tab_pane").hide();var e="";"undefined"!=typeof localStorage&&(e=localStorage.getItem("kopa_active_tab")),""!=e&&t(e).length?(t(e+"_tab").addClass("kopa_nav_active"),t(e).show()):(t(".kopa_nav_tabs li").first().addClass("kopa_nav_active"),t(".kopa_tab_pane").first().show()),t(".kopa_nav_tabs li a").on("click",function(t){t.preventDefault()}),t(".kopa_nav_tabs li").on("click",function(){var e=t(this),o=e.children(".kopa_nav_title"),a=t(o.attr("href"));"undefined"!=typeof localStorage&&localStorage.setItem("kopa_active_tab",o.attr("href")),e.addClass("kopa_nav_active").siblings().removeClass("kopa_nav_active"),a.show().siblings().hide()})}function o(e,o){var n=t("#"+o).val(),i="kopa_style_link_"+o,s=o+"_preview",l=o+"_style",r="kopa_typeface_"+t("#"+o).parents(".kopa_section").attr("id"),_=void 0,u=!1,d=!1,m=!1;if(kopa_system_fonts.indexOf(n)>=0?u=!0:kopa_google_font_families.indexOf(n)>=0?d=!0:p.indexOf(n)>=0&&(m=!0),m){var v=n,k="",h=p.indexOf(n),y=f[h],g=y.woff,w=y.ttf,b=y.svg,I=y.eot,j="";return t("#"+l).attr("disabled","disabled"),t("#"+s).fadeIn(),j+='<style class="'+r+'">\n',j+="@font-face {\n",j+='font-family: "'+v+'";\n',j+="src: ",I&&(j+='url("'+I+'");\n',j+='src: url("'+I+'?#iefix") format("embedded-opentype")'),g&&I?j+=',\nurl("'+g+'") format("woff")':g&&(j+='url("'+g+'") format("woff")'),w&&(g||I)?j+=',\nurl("'+w+'") format("truetype")':w&&(j+='url("'+w+'") format("truetype")'),void(b?t.get(b,function(e){k=t(e).find("font").attr("id"),j+=w||g||I?',\nurl("'+b+"#"+k+'") format("svg")':'url("'+b+"#"+k+'") format("svg")',j+=";\n",j+="}\n",j+="</style>\n",t("."+r).remove(),t("head").append(j),t("#"+s).css("font-family",'"'+v+'"').css("font-style","").css("font-weight","")}):(j+=";\n",j+="}\n",j+="</style>\n",t("."+r).remove(),t("head").append(j),t("#"+s).css("font-family",'"'+v+'"').css("font-style","").css("font-weight","")))}if(t("#"+l).removeAttr("disabled"),t(e).attr("id")===o&&d){var h=kopa_google_font_families.indexOf(n);h>=0&&(_=kopa_google_fonts[h],_.category&&(c=_.category))}if(n)if(t("#"+s).fadeIn(),"none"!==n&&"Select a font"!==n)if(u){var x=t("#"+l).val();if(t(e).attr("id")===o){t("#"+l+" option").remove();var C=["regular","italic","bold","bolditalic"],Q="";for(var h in C)Q=a(C[h]),Q&&t("#"+l).append('<option value="'+C[h]+'">'+Q+"</option>");x&&C.indexOf(x)>=0?t("#"+l).val(x).find('option[value="'+x+'"]').attr("selected","selected"):C.indexOf("regular")>=0?(x="regular",t("#"+l).val("regular").find('option[value="regular"]').attr("selected","selected")):(x=C[0],t("#"+l).val(x).find("option:first").attr("selected","selected"))}"regular"===x&&(x="normal"),t("#"+s).css("font-family",n),t("#"+s).css("font-weight",x.replace("italic","")),x.indexOf("italic")>=0?t("#"+s).css("font-style","italic"):t("#"+s).css("font-style","normal")}else{t("."+i).remove();var O=n.replace(/\s+/g,"+"),x=t("#"+l).val();if(void 0!==_){t("#"+l+" option").remove();var C=_.variants,Q="";for(var h in C)Q=a(C[h]),Q&&t("#"+l).append('<option value="'+C[h]+'">'+Q+"</option>");x&&C.indexOf(x)>=0?t("#"+l).val(x).find('option[value="'+x+'"]').attr("selected","selected"):C.indexOf("regular")>=0?(x="regular",t("#"+l).val("regular").find('option[value="regular"]').attr("selected","selected")):(x=C[0],t("#"+l).val(x).find("option:first").attr("selected","selected"))}"regular"===x&&(x="400"),t("head").append('<link href="http://fonts.googleapis.com/css?family='+O+":"+x+'" rel="stylesheet" type="text/css" class="'+i+'">'),t("#"+s).css("font-family",n+","+c),t("#"+s).css("font-weight",x.replace("italic","")),x.indexOf("italic")>=0?t("#"+s).css("font-style","italic"):t("#"+s).css("font-style","normal")}else t("#"+s).css("font-family",""),t("#"+s).fadeOut()}function a(t){var e={};for(var o in kopa_font_styles)if(e=kopa_font_styles[o],e.style===t)return e.label;return!1}function n(t,e){var o=jQuery(t),a=o.val(),n=e+"_preview";jQuery("#"+n).css("font-size",a+"px")}function i(){var t=jQuery(this),e=t.data("main-id");if(void 0!==e){var o=t.val()?t.val():t.data("default-color"),a=e+"_preview";o?jQuery("#"+a).css("color",o):jQuery("#"+a).css("color","inherit")}}function s(){var e=t(this),o=e.parents(".kopa_controls"),a=o.find(".kopa_custom_font_list"),n=(o.find(".kopa_custom_font_item"),e.data("name")),i=e.data("orders").toString(),s=[];itemCount=0,newItem="",""!==i&&(s=i.split(","),s=t.map(s,function(t){return parseInt(t)})),s.length&&(itemCount=Math.max.apply(null,s),itemCount+=1),s.push(itemCount),i=s.join(","),e.data("orders",i),s=a.find(".kopa_custom_font_order").map(function(){var t=this.value;return t=t.replace(/\D/g,""),t=parseFloat(t)}).get(),newItem+='<div class="kopa_custom_font_item">',newItem+='<div class="kopa_custom_font_top">',newItem+='<div class="kopa_custom_font_title_action">',newItem+="</div>",newItem+='<div class="kopa_custom_font_title">',newItem+="<strong>Custom Font "+(itemCount+1)+"</strong>",newItem+="</div>",newItem+="</div>",newItem+='<div class="kopa_custom_font_inside kopa_hide">';for(var c in kopa_custom_font_attributes){var f=kopa_custom_font_attributes[c],p="kopa_custom_font_item_"+c,u=!1,d="",m="";"name"===c&&f.value&&(m=f.value+" "+(itemCount+1)),"upload"===f.type&&(p+=" kopa_upload"),f.required&&(u=!0),f.mimes&&(d=f.mimes),newItem+='<div class="kopa_section"><div class="kopa_controls">',newItem+='<input class="'+p+'" type="text" name="'+n+"["+itemCount+"]["+c+']" placeholder="'+f.placeholder+'" '+(u?"required ":"")+'data-type="'+d+'" value="'+m+'">',"upload"===f.type&&(newItem+='<input class="kopa_upload_button kopa_button button" type="button" value="'+kopa_admin_l10n.upload+'">'),newItem+="</div></div>"}newItem+='<div class="kopa_custom_font_control_actions">',newItem+='<a class="kopa_custom_font_remove" href="#">'+kopa_sidebar_attributes_l10n.remove+"</a>",newItem+=" | ",newItem+='<a class="kopa_custom_font_close" href="#">'+kopa_sidebar_attributes_l10n.close+"</a>",newItem+="</div>",newItem+="</div>",newItem+="</div>",a.append(newItem);var v=a.children(".kopa_custom_font_item:last"),k=v.find(".kopa_custom_font_title_action");k.addClass("kopa_action_close"),v.children(".kopa_custom_font_inside").slideDown("fast"),v.on("click",".kopa_custom_font_top",l),v.on("click",".kopa_custom_font_close",r),v.on("click",".kopa_custom_font_remove",_)}function l(){var e=t(this),o=e.find(".kopa_custom_font_title_action"),a=e.siblings(".kopa_custom_font_inside");o.hasClass("kopa_action_close")?o.removeClass("kopa_action_close"):o.addClass("kopa_action_close"),a.slideToggle("fast")}function r(e){e.preventDefault();var o=t(this),a=o.parents(".kopa_custom_font_inside"),n=a.siblings(".kopa_custom_font_top"),i=n.find(".kopa_custom_font_title_action");i.removeClass("kopa_action_close"),a.slideUp("fast")}function _(e){e.preventDefault();var o=t(this),a=o.parents(".kopa_custom_font_item");confirm(kopa_admin_l10n.confirm_delete)&&a.slideUp("fast",function(){a.remove()})}Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var o;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),n=a.length>>>0;if(0===n)return-1;var i=+e||0;if(1/0===Math.abs(i)&&(i=0),i>=n)return-1;for(o=Math.max(i>=0?i:n-Math.abs(i),0);n>o;){if(o in a&&a[o]===t)return o;o++}return-1}),jQuery(".kopa_fold").click(function(){var e=".kopa_fold_"+this.id;t(e).slideToggle("fast")}),setTimeout(function(){t(".kopa_message.updated.fade, .kopa_message.error.fade").fadeOut("slow")},3e3),t(".kopa_color").wpColorPicker(),t(".kopa_nav_title").length>0&&e(),t("#kopa_options_wrap .kopa_sidebar_menu_mobile_icon").on("click",function(){t("#kopa_options_wrap ul.kopa_nav_tabs").toggle()}),t(window).resize(function(){t(this).width()>980&&t("#kopa_options_wrap ul.kopa_nav_tabs").show().removeAttr("style")});var c="sans-serif",f=[],p=[];jQuery(".kopa_custom_font_item").each(function(){var t=jQuery(this),e=t.find(".kopa_custom_font_item_name").val(),o=t.find(".kopa_custom_font_item_woff").val(),a=t.find(".kopa_custom_font_item_ttf").val(),n=t.find(".kopa_custom_font_item_svg").val(),i=t.find(".kopa_custom_font_item_eot").val();f.push({woff:o,ttf:a,svg:n,eot:i}),p.push(e)}),jQuery(".kopa_select_font, .kopa_select_font_style").each(function(){var t=jQuery(this).data("main-id");o(this,t)}),jQuery(".kopa_select_font, .kopa_select_font_style").change(function(){var t=jQuery(this).data("main-id");o(this,t)}),jQuery(".kopa_select_font_size").each(function(){var t=jQuery(this).data("main-id");n(this,t)}),jQuery(".kopa_select_font_size").on("keyup change",function(){var t=jQuery(this).data("main-id");n(this,t)}),jQuery(".kopa_select_font_color").wpColorPicker({change:i,clear:i,palettes:!1}),jQuery(".kopa_select_font_color").each(i),t(".kopa_custom_font_list").sortable({items:".kopa_custom_font_item",handle:".kopa_custom_font_top"}),t(".kopa_add_font_button").on("click",s),t(".kopa_custom_font_top").on("click",l),t(".kopa_custom_font_close").on("click",r),t(".kopa_custom_font_remove").on("click",_),t(".kopa_reset").on("click",function(){return confirm(kopa_admin_l10n.confirm_reset)}),t(".kopa_import").on("click",function(){return confirm(kopa_admin_l10n.confirm_import)})});